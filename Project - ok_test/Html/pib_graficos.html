<!DOCTYPE html>
<html lang="pt-BR">
    <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Gráficos do PIB</title>
    <!-- Corrigido temporariamente (henrique) -->
    <link rel="stylesheet" href="../css/test.css">
    <style>
        /* Ajustes específicos desta página */
        .figura { text-align: center; }
        .note { text-align: center; color: rgba(255,255,255,0.8); font-size: 0.95rem; margin-bottom: 12px; }
        /* Spinner */
        #pib-spinner { display:none; position:relative; text-align:center; padding:18px 0; }
        .spinner-dot { width:12px; height:12px; background:#2b8cbe; border-radius:50%; display:inline-block; margin:0 6px; animation: spin 1s infinite ease-in-out; }
        .spinner-dot:nth-child(2){ animation-delay: .15s } .spinner-dot:nth-child(3){ animation-delay: .3s }
        @keyframes spin { 0% { transform: translateY(0);} 50% { transform: translateY(-8px);} 100% { transform: translateY(0);} }
        /* Canvas height */
        .figura canvas { width:100%; height:380px; }
    </style>
    <!-- Chart.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <header class="container" style="padding-top:14px; padding-bottom:6px;">
        <nav style="display:flex;gap:12px;align-items:center;justify-content:space-between;">
            <div style="display:flex;gap:12px;align-items:center;">
                <a href="ok_test.html" class="nav-link" style="color:#fff;text-decoration:none;">Galeria</a>
            </div>
            <div style="font-size:0.95rem;color:rgba(255,255,255,0.85);">Espaço de brainstorm colaborativo</div>
        </nav>
    </header>

    <main class="container">
        <h1>Gráficos do PIB (IBGE)</h1>

        <p class="note">Os gráficos abaixo são gerados dinamicamente quando a página é carregada (dados do IBGE quando disponíveis; fallback para fonte pública se necessário).</p>

        <div id="pib-spinner" aria-hidden="false">
            <span class="spinner-dot"></span>
            <span class="spinner-dot"></span>
            <span class="spinner-dot"></span>
            <div style="color:rgba(255,255,255,0.8);margin-top:8px;">Carregando dados e gerando gráficos...</div>
        </div>

        <section class="card figura">
            <h3 style="text-align:center;color:#ddd;margin-bottom:8px;">PIB por ano</h3>
            <canvas id="chart-pib-ano" aria-label="PIB por ano" role="img"></canvas>
            <p style="text-align:center;color:rgba(255,255,255,0.8);font-size:0.9rem;margin-top:8px;">Fonte: IBGE (Sidra) ou fallback público</p>
        </section>

        <section class="card figura">
            <h3 style="text-align:center;color:#ddd;margin-bottom:8px;">Crescimento anual do PIB (%)</h3>
            <canvas id="chart-crescimento" aria-label="Crescimento anual do PIB" role="img"></canvas>
            <p style="text-align:center;color:rgba(255,255,255,0.8);font-size:0.9rem;margin-top:8px;">Valores percentuais ano a ano</p>
        </section>
    </main>

    <!-- Lightbox + placeholder handling -->
    <div id="lightbox" aria-hidden="true" style="position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,0.8);z-index:1200;">
        <button id="lb-close" aria-label="Fechar" style="position:absolute;top:18px;right:20px;background:none;border:0;color:#fff;font-size:28px;cursor:pointer;">×</button>
        <img id="lb-img" src="" alt="" style="max-width:92%;max-height:86%;border-radius:6px;box-shadow:0 8px 30px rgba(0,0,0,0.7);">
    </div>

    <script src="../js/pib-charts.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const ctx = document.getElementById('chart-pib-ano').getContext('2d');

            // Dados fictícios do PIB do Brasil com zonas máxima e mínima
            const data = {
                labels: ['2018', '2019', '2020', '2021', '2022', '2023', '2024'],
                datasets: [
                    {
                        label: 'PIB do Brasil (em trilhões de R$)',
                        data: [7.0, 7.3, 7.4, 9.0, 10.1, 10.9, 11.4],
                        backgroundColor: 'rgba(75, 192, 192, 0.2)',
                        borderColor: 'rgba(75, 192, 192, 1)',
                        borderWidth: 1
                    },
                    {
                        label: 'Zona Máxima',
                        data: [7.1, 7.6, 7.8, 9.5, 10.5, 11.0, 11.6],
                        type: 'line',
                        borderColor: 'rgba(0, 255, 0, 0.8)',
                        borderDash: [5, 5],
                        fill: false
                    },
                    {
                        label: 'Zona Mínima',
                        data: [6.9, 7.2, 7.3, 8.5, 9.5, 10.0, 10.5],
                        type: 'line',
                        borderColor: 'rgba(255, 0, 0, 0.8)',
                        borderDash: [5, 5],
                        fill: false
                    }
                ]
            };

            // Configuração do gráfico
            const config = {
                type: 'line', // Alterado para gráfico de linhas
                data: data,
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        title: {
                            display: true,
                            text: 'Evolução do PIB do Brasil com Zonas Máxima e Mínima'
                        }
                    }
                },
            };

            // Renderizar o gráfico
            new Chart(ctx, config);
        });

        document.addEventListener("DOMContentLoaded", function () {
            const ctxGrowth = document.getElementById('chart-crescimento').getContext('2d');

            // Dados fictícios de crescimento anual do PIB do Brasil com zonas máxima e mínima
            const growthData = {
                labels: ['2018', '2019', '2020', '2021', '2022', '2023', '2024'],
                datasets: [
                    {
                        label: 'Crescimento Anual do PIB (%)',
                        data: [1.3, 1.1, -4.1, 4.6, 2.9, 3.0, 2.5],
                        backgroundColor: 'rgba(54, 162, 235, 0.2)',
                        borderColor: 'rgba(54, 162, 235, 1)',
                        borderWidth: 1
                    },
                    {
                        label: 'Zona Máxima',
                        data: [1.5, 1.3, -3.8, 5.0, 3.2, 3.3, 2.8],
                        type: 'line',
                        borderColor: 'rgba(0, 255, 0, 0.8)',
                        borderDash: [5, 5],
                        fill: false
                    },
                    {
                        label: 'Zona Mínima',
                        data: [1.1, 0.9, -4.4, 4.2, 2.6, 2.7, 2.2],
                        type: 'line',
                        borderColor: 'rgba(255, 0, 0, 0.8)',
                        borderDash: [5, 5],
                        fill: false
                    }
                ]
            };

            // Configuração do gráfico de crescimento
            const growthConfig = {
                type: 'line',
                data: growthData,
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        title: {
                            display: true,
                            text: 'Crescimento Anual do PIB do Brasil com Zonas Máxima e Mínima'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return value + '%';
                                }
                            }
                        }
                    }
                },
            };

            // Renderizar o gráfico de crescimento
            new Chart(ctxGrowth, growthConfig);
        });
    </script>
</body>

</html>
